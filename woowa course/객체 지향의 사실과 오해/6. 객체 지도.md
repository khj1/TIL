# 객체 지도

길을 찾아가는 방법은 두 가지가 있다.

- 지나가는 사람에게 길을 물어본다.
- 지도를 찾아본다.

길을 물어보는 방법은 기능적이고 해결책 지향적인 접근법이다. 길을 알려주는 사람은 상세하게 이동 경로를 말해줘야 한다. 이 방법은 일반적이지도, 재사용 가능하지도 않다. 설명만으로 경로를 찾기가 쉬운 일은 아니다.

이에 비해 지도를 찾아보는 방법은 구조적이고 문제 지향적인 접근법이다. 지도는 실세계의 지형을 기반으로 추상화된 모델이다. 길을 찾아가는 구체적인 경로가 아니라 전체적인 구조를 제공한다. 또한 지도는 여러 목적으로도 활용 될 수 있기에 범용적이다.

이 은유의 핵심은 구조 기반의 모델을 구축하는 것이 더 범용적이고 이해하기 쉬우며 변경에 안정적이라는 것이다. 자주 변경되는 기능이 아니라 안정적인 구조를 기반으로 시스템을 분할하는 객체지향적인 접근법으로 역할, 책임, 협력을 구성해야한다.

## 기능 설계 대 구조 설계

- 기능 설계는 제품이 무엇을 할 수 있는지에 초점을 맞춘다.
- 구조 설계는 제품의 형태가 어떠해야 하는지에 초점을 맞춘다.

성공적인 소프트웨어는 사용자들에게 필요한 기능을 제공함과 동시에 사용자가 원하느 새로운 기능을 빠르게 추가할 수 있다.

소프트웨어 세계에서 변하지 않는 하나의 사실은 요구사항이 변한다는 것이다. 우리는 미래를 예측할 수 없지만 미래를 대비할 순 있다. 훌륭한 설계란 나중에라도 변경할 수 있는 여지를 남겨놓는 설계다.

변경의 여지를 남겨두는 가장 좋은 방법은 안정적인 구조를 중심으로 설계한 후 기능이 구조에 따르게 하는 것이다.

## 안정적인 재료: 구조

### 도메인 모델

은행에서는 고객의 소중한 자산을 관리하고 보호하기 위해 소프트웨어를 사용한다. 병원에서는 환자의 진료 기록을 보관하고 분석하기 위해 소프트웨어를 사용한다. 이처럼 사용자가 프로그램을 사용하는 대상 분야를 **도메인**이라고 한다.

도메인 모델이란 사용자가 프로그램을 사용하는 대상 영역에 관한 지식을 선택적으로 단순화하고 의식적으로 구조화한 형태다.

### 표현적 차이

소프트웨어 객체와 현실 객체 사이의 의미적 거리를 가리켜 **표현적 차이**또는 의미적 차이라고한다. 핵심은 은유를 통해 이 차이를 좁히는 것이다.

우리가 은유를 통해 투영해야하는 대상은 도메인 모델이다. 소프트웨어 객체는 그 대상이 현실적인지를 떠나 도메인 모델을 통해 표현되는 도메인 객체들을 은유해야 한다.

도메인 모델은 코드 안에 존재하는 미로를 헤쳐나갈 수 있는 지도를 제공한다.

### 불안정한 기능을 담는 안정적인 도메인 모델

도메인 모델의 핵심은 사용자가 도메인을 바라보는 관점을 반영해 소프트웨어를 설계하고 구현하는 것이다.

## 불안정한 재료: 기능

### 유스케이스

기능적 요구사항이란 시스템이 사용자에게 제공해야 하는 기능의 목록을 정리한 것이다. 훌륭한 기능적 요구사항을 얻기 위해서는 목표를 가진 사용자와 사용자의 목표를 만족시키기 위해 일련의 절차를 수행하는 시스템 간의 상호작용에 초점을 맞춰야한다.

이처럼 사용자의 목표를 달성하기 위해 사용자와 시스템 간에 이뤄지는 상호작용의 흐름을 텍스트로 정리한 것을 유스케이스라고 한다.

유스케이스를 통해 요구사항을 기억하고 관리하는 데 필요한 다양한 정신적 과부하를 줄일 수 있다. (우테코 미션의 프로그램 실행 예시가 유스케이스 역할을 하고있는 듯하다.)

### 유스케이스의 특성

- 사용자와 시스템 간의 상호작용을 보여주는 텍스트다.
- 여러 시나리오들의 집합이다.
    - 이자 계산 유스케이스는 2가지 시나리오를 포함하고 있다.
        - 예금주가 당일까지의 이자액을 계산한다.
        - 예금주가 특정일자까지의 이자액을 계산한다.
    - 시나리오는 **유스케이스 인스턴스**라고도 한다.
- 유스케이스는 단순한 기능 목록과는 다르다.
    - 기능 목록은 서로 다른 두 기능의 연관성은 배제하고 독립적으로 보이게 만든다.
- 사용자 인터페이스와 관련된 세부 정보를 포함하지 말아야 한다.
- 내부 설계와 관련된 정보를 포함하지 않는다.

### 유스 케이스는 설계 기법도, 객체지향 기법도 아니다.

유스 케이스가 단순히 사용자가 바라보는 시스템의 외부 관점만을 표현한다는 것에 주목하라. 유스 케이스는 단순히 사용자가 시스템을 통해서 무엇을 얻을 수 있고 어떻게 상호작용할 수 있느냐네 관한 정보만 기술된다.

유스 케이스를 객체로 변환하는 작업은 순수하게 창조적이고 예술적인 작업이다.

## 재료 합치기: 기능과 구조의 통합

### 도메인 모델, 유스 케이스, 그리고 책임-주도 설계

도메인 모델은 안정적인 구조를 개념화하기 위해, 유스 케이스는 불안정한 기능을 서술하기 위해 가장 일반적으로 사용되는 도구다. 변경에 유연한 소프트웨어를 만들기 위해서는 유스케이스에 정리된 시스템의 기능을, 도메인 모델을 기반으로 한 객체들의 책임으로 분배해야 한다.

> 객체 설계는 다음과 같이 표현되기도 한다. <br>
> - 요구사항들을 식별하고 도메인 모델을 생성한다.
> - 소프트웨어 클래스에 메서드들을 추가한다.
> - 요구사항을 충족시키기 위해 객체들 간의 메시지 전송을 정의한다.

### 기능 변경을 흡수하는 안정적인 구조

도메인 모델을 기반으로 객체를 설계하는 이유는 도메인 모델인 안정적이기 때문이다.

- 도메인 모델을 구성하는 개념은 비즈니스가 없어지거나 완전히 개편되지 않는 한 안정적으로 유지된다.
- 도메인 모델을 구성하는 개념들의 관계는 비즈니스 규칙을 기반으로 하기 때문에 비즈니스 정책이 크게 바뀌지 않는 한 안정적으로 유지된다.

비즈니스 정책이나 규칙이 크게 변경되지 않는 한 시스템의 기능이 변경되더라도 객체 간의 관계는 일정하게 유지된다. 이것은 변경에 대한 파급효과를 최소화하고 요구사항 변경에 유연하게 대응할 수 있는 시스템을 구축할 수 있게 한다.

객체지향의 가장 큰 장점은 도메인을 모델링하기 위한 기법과 도메인을 프로그래밍하기 위한 기법이 동일하다는 것이다. 따라서 도메인 모델링에서 사용한 객체와 개념을 프로그래밍 설계에서의 객체와 클래스로 매끄럽게 변환할 수 있다. 이와 같은 객체지향의 특성을 **연결 완전성**이라고 한다.

객체지향이 강력한 이유는 연결 완전성의 역방향 역시 성립한다는 것이다. 즉 코드의 변경으로부터 도메인 모델의 변경 사항을 유추할 수 있다. 이와 같은 특성을 **가역성**이라고 한다.

사람들이 동일한 용어와 동일한 개념을 이용해 의사소통하고 코드로부터 도메인 모델을 유추할 수 있게 하는 것이 도메인 모델의 진정한 목표다.

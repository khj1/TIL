# OSI(Open Systems Interconnection) 7 Layer
## Physical Layer
#### 두 대의 컴퓨터가 통신하려면?
- 모든 파일과 프로그램은 0과 1의 나열이다.
- 결국 0과 1만 주고받을 수 있으면 된다.
- 두 대의 컴퓨터를 하나의 전선으로 연결한다고 가정해보자.
  - 1을 보낼 때는 +5V의 전기를 전선으로 흘려보낸다.
  - 0을 보낼 때는 -5V의 전기를 전선으로 흘려보낸다.
  - 0과 1을 주고받을 수 있으면 모든 데이터를 주고받을 수 있으므로
  - 연결된 두 컴퓨터는 모든 데이터를 주고받을 수 있게 된다.

#### 하지만 이 방법은 실제 상황에선 제대로 동작하지 않는다.
- 전기는 전자기파를 통해 전송되는데 전자기파는 파동을 기반으로 한 그래프로 표현될 수 있다.
- 실제 전자기파의 주파수는 일정하거나 고정된 값을 가지지 않고 파동이 진행되는 동안 계속 변화한다.
- 0과 1을 전송하는 전자기파는 직각으로 이루어진 수평선으로 표현될 수 있다.
- 이러한 수평선 전자기파의 범위는 이론상 0 ~ 무한대의 Hz의 범위를 갖는데 현실에서 이러한 범위의 전자기파를 통과시킬 수 있는 전선은 존재하지 않는다.
- 이러한 문제를 해결하기 위해 수평선 전자기파를 곡선의 형태를 띈 아날로그 신호로 변환해줘야한다.

### Physical Layer 정리
- 0과 1의 나열을 아날로그 신호로 바꾸어 전선으로 흘려보내고. (encoding)
- 아날로그 신호가 들어오면 0과 1의 나열로 해석하여. (decoding)
- 물리적으로 연결된 두 대의 컴퓨터가 0과 1의 나열을 주고받을 수 있게 해주는 모듈 (module)

> 여기서 말하는 모듈은 일종의 함수와 같은 기능을 한다고 보면 된다.

### Physical Layer 기술은 어디에 구현되어 있을까?
- PHY 칩
- 1계층 모듈은 하드웨어적으로 구현되어 있다.

## Data-Link Layer
### 여러 대의 컴퓨터가 통신하려면?
- 연결해야하는 컴퓨터가 늘어날수록 필요한 전선과 전선을 꽂을 구멍도 늘어나야한다.
- 통신하려는 컴퓨터가 많아질수록 비용 면에서 비효율적이다.
- 따라서 전선 하나만으로 여러 대의 컴퓨터와 통신할 수 있는 방법을 모색해야한다.
- 하나의 길고 큰 구리선을 준비하고, 선을 나누어서 갈래 갈래 여러 대의 컴퓨터와 연결해준다.
- 하지만 이런 방식은 구리선과 연결된 모든 컴퓨터에 데이터를 동일하게 전송한다는 문제가 있다.
- 구리선을 상자에 담고 상자에서 선을 빼내서 컴퓨터에 연결하는 모형을 상상해보자.
- 만약 상자가 데이터와 데이터의 목적지를 확인해서 특정 컴퓨터에만 전송하도록 해준다면 위의 문제가 해결될 것이다.
- 이러한 상자를 **스위치**라고 부른다.
- 하나의 스위치와 스위치에 연결된 다수의 컴퓨터의 집합을 네트워크, 또는 인트라넷이라고 부르자.
- **하나의 네트워크에서 다른 네트워크로 연결하고자할 때는 어떻게 해야할까?**
- 스위치와 스위치를 연결해서 서로 다른 네트워크에 속한 컴퓨터끼리 통신할 수 있게 해주는 장비를 **라우터(공유기)**라고 한다.
- 라우터는 스위치의 역할도 수행하고 라우터의 역할도 수행한다. 
- 보통 그냥 라우터라고 통칭한다. 라우터와 라우터는 또 다른 라우터로 연결될 수 있다.
- 이런식으로 전 세계의 컴퓨터들이 **계층구조** 형태로 연결될 수 있는데 이를 **인터넷**이라고 한다.

### Data-Link Layer는 어떤 방식으로 동작할까?
- 동일한 네트워크에 속해 있는 여러 대의 컴퓨터에서 특정 컴퓨터로 동시에 데이터를 전송한다고 가정해보자.
- 데이터 송신자에 대한 구별이 이루어지지 않으면 전달받은 데이터(0과 1로 이루어짐)가 합쳐져 왜곡될 수 있다.
- 이를 해결하기 위해 송신자는 데이터의 앞 뒤에 특정한 비트열을 붙인다.
- 이런 방식을 통해 동시에 전달된 여러 개의 데이터를 구분해서 읽을 수 있다.
- 같은 네트워크에 있는 여러 대의 컴퓨터들이 데이터를 주고받기 위해서 필요한 모듈
- Framing은 Data-Link Layer에 속하는 작업들 중 하나다.
- Data-Link Layer를 통해 데이터의 앞 뒤에 송신자 구분 비트열을 붙이고
- Physical Layer를 통해 0과 1로 이루어진 데이터를 아날로그 신호로 변환시켜 전선으로 전송한다.

### Data-Link Layer 기술은 어디에 구현되어 있을까?
- 랜카드
- 2계층 모듈도 1계층 모듈처럼 하드웨어적으로 구현되어 있다.

## Network Layer
### 더 많은 컴퓨터들 사이의 통신
- A 컴퓨터는 데이터 앞에 목적지 주소, 즉 B 컴퓨터의 주소를 붙인다.
- 이러한 목적지 주소를 **IP 주소**라고 한다. (IP 주소는 고유한 값이다.)
- 그렇다면 A는 B의 IP 주소를 어떻게 알고있는 걸까?
- 우리가 웹 브라우저에 입력하는 도메인에는 IP 주소가 할당되어 있다. (DNS)
- 우리가 특정 목적지의 도메인을 알고 있다면 IP 주소를 알고있는 것이나 마찬가지다.
- A는 목적지 주소와 데이터를 합쳐서 보내는데 이를 **패킷**이라고 부른다.
- A는 패킷을 '가'라는 라우터로 전달한다.
- '가'는 패킷을 열어서 목적지 주소를 확인한다.
- 목적지 주소가 '가' 라우터와 연결되어있지 않다면 '가'는 패킷을 다시 생성해서 상위 라우터인 '마'로 전달한다.
- 상위 라우터인 '마'는 패킷을 전달받아서 똑같이 패킷을 열어보고 목적지 주소를 확인한다.
- '마'는 목적지 주소가 어떤 라우터와 연결되어 있는지 파악하고 이에 맞는 라우터 '바'로 패킷을 전송한다.

> '마'와 연결된 라우터가 굉장히 많을텐데 어떻게 '마'는 목적지 주소와 연결된 라우터를 파악하고 정확한 위치로 전달할 수 있는걸까? **라우팅** 기술을 공부해보자.

### 그래서 결국 Network Layer란?
- 수많은 네트워크들의 연결로 이루어진 **inter-network** 속에서
- 어딘가에 있는 목적지 컴퓨터로 데이터를 전송하기 위해
- IP 주소를 이용해서 길을 찾고 (**routing**)
- 자신 다음의 라우터에게 데이터를 넘겨주는 것 (**forwarding**)

### Network Layer 기술은 어디에 구현되어 있을까?
- 운영체제의 커널에 소프트웨어적으로 구현되어 있다.

## Transport Layer
- 이제 전 세계의 컴퓨터로부터 데이터를 받을 수 있게 됐다.
- 그런데 컴퓨터에는 여러 개의 프로그램들이 실행되고 있다.

> 실행중인 프로그램은 **프로세스**라고 한다.

- 그런데 전달받은 여러 개의 데이터 중에 어떤 데이터를 무슨 프로세스에게 줘야할 지 어떻게 구분할 수 있을까?
- 데이터를 받고자하는 프로세스들은 **포트 번호**를 가져야 한다.
- **하나의 컴퓨터에서 동시에 실행되고 있는 프로세스들이 서로 겹치지 않게 가져야하는 정수 값**을 포트 번호라고 한다.
- 송신자는 데이터를 보낼 때 데이터를 받을 수신자 컴퓨터에 있는 프로세스의 포트 번호를 붙여서 보낸다.
- 그렇다면 송신자는 수신자의 포트 번호를 미리 알고 있어야한다.
- 웹 브라우저의 도메인에는 사실 포트 번호가 존재하는데, 포트 번호는 생략되어 표기되고 있다.

### 그래서 결국 Transport Layer란?
- 포트 번호를 사용하여
- 목적지 컴퓨터의 최종 도착지인 프로세스에 까지
- 데이터가 도달하게 하는 모듈

### Transport Layer 기술은 어디에 구현되어 있을까?
- 운영체제의 커널에 소프웨어적으로 구현되어 있다.

## Application Layer
- Application Layer는 OSI 7 Layer의 최상위 계층이다.
- Application Layer 이전에 Presentaion Layer, Session Layer가 있는데 왜 바로 Application Layer로 넘어왔을까?
- 사실 현대의 인터넷은 OSI 모델이 아니라 TCP/IP 모델을 따르고 있다.
- 그 이유는 OSI 모델이 TCP/IP 모델과의 시장 점유율 싸움에서 패배했기 때문이다.
- TCP/IP 모델은 1부터 4계층까진 OSI 7 Layer와 완전히 동일한 구조를 갖고있다.
- 다만 OSI 7 Layer의 Presentaion Layer, Session Layer, Application Layer가 하나의 Application Layer로 묶여서 설명되고 있다.

### TCP/IP 소켓 프로그래밍
- 운영체제의 Transport Layer에서 제공하는 API를 활용해서 통신 가능한 프로그램을 만드는 것을 TCP/IP 소켓 프로그래밍 또는 네트워크 프로그래밍이라고 한다.
- 소켓 프로그래밍 만으로도 클라이언트, 서버 프로그램을 따로 만들어서 동작시킬 수 있다.
- 소켓 프로그래밍을 통해서 누구나 자신만의 Application Layer 인코더와 디코더를 만들 수 있다.
- 즉 누구나 자신만의 Application Layer 프로토콜을 만들어서 사용할 수 있다는 뜻이다.
- Application Layer도 다른 계층과 마찬가지로 인코더와 디코더를 갖고 있다.
- 대표적인 예로 HTTP
- HTTP는 우리가 기존에 알고있던 Request Header, Body, Status Code 등등의 요소를 데이터와 합쳐서 인코딩한다.

> Layered Architecture를 따르는 대표적인 예가 바로 네트워크 시스템이다. <br /> 
> 따라서 네트워크 시스템은 하나의 거대한 소프웨어라고 할 수 있다. <br /> 
> 즉 OSI 7 Layer 모델은 거대한 네트워크 소프트웨어의 구조를 설명하는 것이다.

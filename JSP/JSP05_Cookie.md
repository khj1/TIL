# 쿠키 (Cookie)
## 쿠키란
- 쿠키는 상태 정보를 유지하기 위한 기술로 클라이언트의 PC나 웹브라우저에 저장되는 간단한 정보를 의미한다. 
- 웹 서버는 웹 브라우저가 전송한 쿠키를 사용해 필요한 데이터를 읽어올 수 있다.
- 쿠키는 그 크기가 하나에 4KB 이하로 제한되어 있으며, 총 300개 까지 정보를 저장할 수 있다. 따라서 최대 저장 가능한 쿠키의 용량은 1200KB 즉, 1.2MB 정도이다.
- 한글 등을 쿠키 값에 포함하려면 반드시 인코딩 처리를 해줘야한다.
  - ```URLEncoder.encode("쿠키값", "euc-kr");```
  - 인코딩 값을 euc-kr로 지정해 준 이유는 쿠키가 웹 서버가 아닌 사용자의 로컬 PC에 저장되기 때문이다.

## 쿠키의 주요 메소드
- ```String getName()``` 
  - 쿠키의 이름을 리턴한다.
- ```String getValue()```
  - 쿠키의 값을 리턴한다.
- ```String getPath()```
  - 쿠키의 적용 경로를 리턴한다. 단, ```setPath()```로 설정을 해주지 않으면 null값을 반환한다.
- ```int getMaxAge()```
  - 쿠키의 유효시간을 리턴한다. 단, ```setMaxAge()```로 설정하지 않으면 -1을 반환한다.
  - 쿠키의 유효시간은 초단위로 설정된다. 유효시간을 설정하지 않으면 쿠키 정보는 웹 브라우저 메모리에 저장되고 웹 브라우저를 닫으면 자동으로 삭제된다. 유효시간을 설정하는 경우 쿠키 정보는 사용자의 로컬 PC에 저장된다.
  - 쿠키를 삭제하고 싶으면 같은 이름의 쿠키 객체를 생성해주고 쿠키 값을 빈값, 쿠키 유효시간을 0으로 설정해서 쿠키에 추가해주면 된다.
- ```setValue()```
  - 쿠기의 값을 설정한다.

## 쿠키 설정 절차 및 동작 방식
- 클라이언트가 처음 서버에 접근하면(request with no cookie) 서버는 쿠키를 생성하고 http 응답 헤더에 쿠키를 실어서 클라이언트 측으로 보낸다.
- **이후에 사용자가 그 사이트를 다시 방문하는 경우**(request with cookie) 웹 브라우저는 저장된 쿠키 정보를 요청헤더를 통해 서버로 전송한다.
- 서버는 이 쿠키 정보를 이용해 필요한 작업을 수행한다.

## 쿠키 생성
    ```jsp
    Cookie cookie = new Cookie("쿠키 이름", "쿠키 값");
    response.addCookie(쿠키객체);
    ```
  - 쿠키명을 설정하는 별도의 setName() 메소드가 존재하지 않기때문에 반드시 생성자를 통해 쿠키명을 지정해줘야한다. 
  - 만약 동일한 쿠키 이름이 이미 존재한다면. 기존 쿠키 값은 새로운 값으로 대체된다.

## 쿠키의 적용 경로 설정
    ```jsp
    cookie.setPath(request.getContextPath());
    ```
    - 쿠키의 적용 경로를 컨텍스트 루트로 지정해주면 웹 어플리케이션 전체에서 해당 쿠키를 사용할 수 있다.

## 쿠키에 저장된 값 읽어오기
    ```jsp
    Cookie[] cookies = request.getCookies();
    for(배열크기만큼 Loop){
        쿠키명: cookies[i].getName();
        쿠키값: cookies[i].getValue();
    }
    ```

## 부록
- 레이어 팝업창을 만드는 예제(PopupMain.jsp 참고)에서 폼값의 target을 iframe으로 지정해줬다. 그 이유는 무엇일까?
  -  폼값의 target을 따로 지정해주지 않으면 해당 페이지 내에 폼값이 전송되고 그 과정에서 해당 페이지 전체가 한번 깜빡거린다. 이를 막기 위해 폼값의 target을 iframe 영역으로 지정해준 것이다.
  -  만약 폼값의 경로를 "https://naver.com"으로 지정해주고 폼 값의 target을 지정해주지 않으면 submit을 실행했을 때 해당 페이지에 네이버가 실행된다.
  - target으로 지정해준 iframe의 display를 hidden으로 설정해줌으로써 사용자는 폼값이 전송되는 것을 눈치챌 수 없다.

- 쿠키 vs 캐시
  - 쿠키와 캐시는 모두 정보를 저장하기 위한 공간이다.
  <br><br>
  - 쿠키는 사용자의 인증을 도와준다.
  - 쿠키는 기본적으로 웹서버에서 PC로 보내는 작은 파일들을 저장한다.
  - 쿠키는 만료 기간이 있어 시간이 지나면 자동으로 삭제된다.
  - 로그인 정보, 방문 기록, 방문 횟수 등 사용자가 입력한 내용들이 저장된다.
  <br><br>
  - 캐시는 웹 페이지가 더 빠르게 렌더링 할 수 있도록 도와준다.
  - 캐시는 웹 페이지 요소들을 저장하기 위한 임시 저장소이다.
  - 캐시는 사용자가 직접 수동으로 삭제해줘야 한다.
  - 오디오, 비디오 파일등 웹 페이지를 구성하는 요소들이 임시적으로 저장된다.